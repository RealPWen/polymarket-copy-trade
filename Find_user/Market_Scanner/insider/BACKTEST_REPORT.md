# Insider Finder 历史回测报告

## 概述

本文档记录了对 Insider Finder 算法在 Trump Win 2024 市场 (market_id=253591) 上的历史回测结果。

## 回测设计

### 目标
验证：如果我们在 **2024年10月15日**（选举前3周）运行 insider detection，能否识别出最终盈利最多的钱包？

### 方法
1. **数据源**: poly_data 本地归档 (1GB+ Trump 市场交易数据)
2. **模拟日期**: 2024-10-15 (只使用此日期前的数据)
3. **结算日期**: 2024-11-06 (Trump 胜选)
4. **分析范围**: 从交易流中提取所有钱包（非排行榜）

### 检测指标
1. **时间集中度**: 是否在短窗口内突击交易?
2. **交易大小异常**: 是否有超常大单?
3. **时机分析**: 是否 BURST 模式?
4. **方向性**: 是否高信念单方向?

## 回测结果

### 模式对比

| 模式 | 分析钱包数 | Score-PnL 相关性 | Top20 Overlap |
|------|------------|------------------|---------------|
| All Wallets | 15,142 | 0.0186 | 2/20 (10%) |
| Only YES Bettors | 2,952 | **0.062** | **4/20 (20%)** |

### 关键指标

- **Score-PnL 相关性**: 0.062 (在 YES 方向过滤后)
- **Top 20 Overlap**: 4/20 = 20%
  - `0x9a73373b3f0e4af0f91eab0f1919edccb898f447` ✅
  - `0x56687bf447db6ffa42ffe2204a05edaa20f55839` (Theo4) ✅
  - `0xb33d95f62714c3522ac133de55ba941927fe0392` ✅
  - `0x0488087c529b1ef5b399b3d031d7b51c9a46bab2` ✅

### Theo4 案例分析

| 指标 | 值 |
|------|-----|
| Insider Score | 155 (Top 5) |
| 历史交易量 | $1,074,024 |
| 最终 PnL | **$9,049,280** |
| ROI | 70.36% |
| 活跃天数 | 1 天 |
| 交易模式 | BURST |
| Size Ratio | 147,683x (极端异常) |
| Token1 Bias | 0.902 (高信念做多) |

**结论**: 我们的算法成功将 Theo4 识别为 Top 5 Insider Candidate！

### Top 10 Insider Candidates (YES 方向)

| Rank | Address | Score | PnL | ROI | Correct Side |
|------|---------|-------|-----|-----|--------------|
| 1 | 0x9175ca... | 165 | $99,174 | 83.6% | ✅ |
| 2 | 0x073a8e... | 155 | $100,998 | 84.3% | ✅ |
| 3 | 0x84bc2e... | 155 | $62,732 | 53.8% | ❌ |
| 4 | 0x9a7337... | 155 | **$882,952** | 123.3% | ✅ |
| 5 | 0x56687b... (Theo4) | 155 | **$9,049,280** | 70.4% | ✅ |
| 6 | 0x983add... | 145 | $96,928 | 227.4% | ✅ |
| 7 | 0x0488087... | 145 | $277,691 | 223.4% | ✅ |
| 8 | 0xe3f93d... | 145 | $5,540 | 78.5% | ✅ |
| 9 | 0xb33d95... | 145 | $576,878 | 81.1% | ✅ |
| 10 | 0xc6587b... | 145 | -$1,562,880 | -88.4% | ✅ |

**Top 10 中 8/10 盈利!**

## 问题分析

### V1 问题：方向盲区
原始算法检测的是**行为异常**，但未区分方向。结果：
- 检测到大量做空者（BURST 模式，高方向性）
- 这些做空者表现得像 insider，但**方向错了**
- 最终亏损巨大

### V2 改进：方向过滤
加入方向过滤后，只分析做多 Trump 的钱包：
- 剔除做空者
- 相关性显著提升 (0.0186 → 0.062)
- Overlap 翻倍 (10% → 20%)

## 实时应用挑战

### 核心问题
**在实时场景下，我们不知道"正确方向"是什么！**

回测中我们用 `winning_token = "token1"` 过滤，但实际运行时无此信息。

### 解决思路

1. **双向监控**: 同时跟踪两个方向的高分钱包
   - 如果 YES 方向出现高分异常钱包 → 可能有 insider 做多
   - 如果 NO 方向出现高分异常钱包 → 可能有 insider 做空

2. **方向不对称检测**: 
   - 如果 YES 方向的 insider score 显著高于 NO 方向 → 信号偏多
   - 反之 → 信号偏空

3. **跟踪已知 insider**:
   - 维护历史成功 insider 钱包列表
   - 当这些钱包在新市场交易时，关注其方向

4. **组合信号**:
   - 结合市场价格变化 + insider 方向
   - 如果价格上涨 + 高分钱包做多 = 强烈看多信号

## 下一步

1. [ ] 实现双向 insider 监控
2. [ ] 构建 insider 信号 → 方向偏好 的推断逻辑
3. [ ] 多市场验证算法稳定性
4. [ ] 实时监听 + insider tracking 功能

---

## Update: 增量流向分析 (Incremental Flow Analysis)

### 方法论改进

之前的累计分析有问题：
- ❌ 累计看所有历史数据 → 无法区分"早入场者"和"事件前突击者"
- ✅ **增量分析每日新增资金流向** → 识别"新钱包"的方向偏好

### 关键发现

对 Trump Win 2024 市场进行每日增量分析：

| 日期 | 总交易量 | YES 买入 | NO 买入 | 新钱包方向 |
|------|----------|----------|---------|------------|
| 10/12 | $22.7M | $16.8M | $5.9M | **+0.861** |
| 10/16 | $21.1M | $17.9M | $3.2M | **+0.827** |
| 11/03 | $57.9M | $41.3M | $16.6M | **+0.832** |
| 11/04 | $72.1M | $51.4M | $20.7M | **+0.841** |

**结论**:
- **所有30天都是 YES 信号** (100%)
- 新钱包一直偏向买 YES (Trump)
- **选前2-3天新钱包方向达到峰值**
- 这验证了 "insider 在事件前突击" 的假设

### 为什么增量分析更有效？

1. **累计分析问题**：
   - 大量做空者也符合 "insider 行为特征" (burst pattern, high conviction)
   - 但他们方向错了，全部亏损
   - 无法区分聪明钱和过度自信的散户

2. **增量分析优势**：
   - 关注**每天新进入的资金**流向
   - 新钱包/新资金 = 增量信息
   - 持续跟踪方向偏好变化

### 实时应用策略

基于此发现，实时监控应该：
1. **每小时/每天计算增量流向**
2. **关注 "new_wallet_direction"** - 新钱包的方向偏好
3. **检测方向突变** - 如果新钱包方向突然反转，可能是重要信号
4. **结合交易量** - 高交易量 + 强方向信号 = 更可靠

---

*报告更新时间: 2026-02-02*
*分析脚本: spike_detector.py, smart_money_detector.py*
